##
## Beschreibung: 
##

- Titel: Minecraft Datapack Tutorial [1.21.6+] #010 - Questreihe Teil 3 - Dialog + Tellraw beim Dorfschmied

- Video: Preparing to Public

- Unterstützungslink: https://www.amazon.de/hz/wishlist/ls/SG7NGDIC0GEK?ref_=wl_share


## Ziel der Folge:

- Villager Dorfschmied ansprechen mit Dialog / Tellraw und beim Lagerverwalter ein Tellraw im Chat auslösen

## Agenda zum Video:

1. Recape Folge 009
2. Was soll in der Folge entsehen?!
3. Villager Wechsel von Tellraw auf Dialog beim Dorfschmied
4. Tellraw mit Farbe beim Dorfschmied
5. Summon mit Villager Lagerverwalter
6. Tellraw mit Farbe beim Lagerverwalter
7. Questfortschritt mit Scoreboard
8. Zusammenfassung

##
## ============================================================================================================================================
##

## Wissen - Links:
 Dialog: DE: https://de.minecraft.wiki/w/Befehl/dialog // EN:https://minecraft.wiki/w/Commands/dialog
Villager Generatoren
- https://mcstacker.net/
- https://www.gamergeeks.net/apps/minecraft/mob-generator/summon-villager  ///  https://www.gamergeeks.net/apps/minecraft/summon
- https://www.digminecraft.com/generators/villager_trade.php
Tellraw
- https://de.minecraft.wiki/w/Befehl/tellraw
Dialog
- https://minecraft.wiki/w/Dialog
Dialog Generator:
- https://misode.github.io/dialog/

##
# Verwendete Befehle:
- function (Folge 001)
- execute if/unless entity (Execute in Folge 005)
- Handling execute mit scores und fehlenden Eintrag im Scoreboard (Folge 008)
- tellraw mit Farbe (Folge 008)
- kill 
- summon villager (Lagerverwalter)
- dialog (Folge 008)
- @e, @a -> score, distance, type 


##
## ============================================================================================================================================
##

# Struktur erweitern

- Datapack Struktur herstellen
    + Main
        + data
            + quests_dorf1
                + dialog
                    > dorf1_dorfschmied10.json
                + function
                    + dialoge
                        + lagerverwalter
                            > dialog_lagerverwalter.mcfunction
                    + entities
                        > check_lagerveralter.mcfunction
    



##
## ============================================================================================================================================
##

# JSON, neu: dialog > dorf1_dorfschmied10.json
{
    "type": "minecraft:confirmation",
    "title": "Dorfschmied",
    "body": {
        "type": "minecraft:plain_message",
        "contents": "Oh der Dorfvorsteher schickt dich zu mir, leider kann ich  dir gerade nicht helfen. Mir fehlt Kohle, der Bote aus der Kohlemine hat mir schon länger nichts gebracht.\n\nAber könntest du für mich zum Lager gehen, und beim Verwalter mal nachfragen ob er noch was hat?\n\n\nMöchtest du die Quest annehmen? (Ja / Nein)"
    },
    "inputs": [],
    "can_close_with_escape": true,
    "after_action": "close",
    "yes": {
        "label": "Ja",
        "action": {
            "type": "minecraft:run_command",
            "command": "scoreboard players set @s Quest_Dorfvorsteher 20"
        }
    },
    "no": {
        "label": "Nein"
    }
}

# Funktion, Bearbeitet: dialoge_switch.mcfunction
execute at @a[scores={Villager_Klick_Dorf1=1}] unless entity @a[scores={Quest_Dorfvorsteher=0..}] if entity @a[distance=..5] run scoreboard players set @a Quest_Dorfvorsteher 1

execute at @e[type=villager,tag=dorf1_dorfvorsteher] if entity @a[distance=..5] run function quests_dorf1:dialoge/dorfvorsteher/dialog_dorfvorsteher
execute at @e[type=villager,tag=dorf1_dorfschmied] if entity @a[distance=..5] run function quests_dorf1:dialoge/dorfschmied/dialog_dorfschmied
execute at @e[type=villager,tag=dorf1_lagerverwalter] if entity @a[distance=..5] run function quests_dorf1:dialoge/lagerverwalter/dialog_lagerverwalter



scoreboard players set @a Villager_Klick_Dorf1 0

# Function, Neu: check_lagerveralter.mcfunction
execute if score _in_work Global_Variables matches 0 unless entity @e[type=minecraft:villager,tag=dorf1_lagerverwalter] run summon villager 1721 66 295 {VillagerData:{type:plains,profession:nitwit,level:99},CustomName:[{text:Lagerverwalter,bold:true}],Invulnerable:1b,NoAI:1b,NoGravity:1b,OnGround:1b,PersistenceRequired:1b,Rotation:[270f,0f],Tags:["dorf1","dorf1_lagerverwalter"]}

# Function, Neu: dialog_lagerverwalter.mcfunction
#dialog show @a[scores={Villager_Klick_Dorf1=1,Quest_Dorfvorsteher=10}] quests_dorf1:dorf1_dorfschmied10

tellraw @a[scores={Villager_Klick_Dorf1=1,Quest_Dorfvorsteher=..19}] [{"color":"gold","text":"Lagerverwalter: "},{"color":"yellow","text":"Ich bin gerade beschäftigt, ich kann dir nicht helfen."}]
tellraw @a[scores={Villager_Klick_Dorf1=1,Quest_Dorfvorsteher=20..}] [{"color":"gold","text":"Lagerverwalter: "},{"color":"yellow","text":"Ich bin gerade beschäftigt, der Schmied muss warten."}]

# Function, Bearbeitet: dialog_dorfschmied.mcfunction
dialog show @a[scores={Villager_Klick_Dorf1=1,Quest_Dorfvorsteher=10}] quests_dorf1:dorf1_dorfschmied10

tellraw @a[scores={Villager_Klick_Dorf1=1,Quest_Dorfvorsteher=..9}] [{"color":"gold","text":"Dorfschmied: "},{"color":"yellow","text":"Ich kann nichts für dich tun."}]
tellraw @a[scores={Villager_Klick_Dorf1=1,Quest_Dorfvorsteher=11..}] [{"color":"gold","text":"Dorfschmied: "},{"color":"yellow","text":"Geh bitte zum Lagerverwalter."}]

